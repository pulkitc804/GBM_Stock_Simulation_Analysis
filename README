# ğŸ“Š GBM Stock Market Analysis & ML Prediction System

A comprehensive Python framework for stock market analysis, prediction, and algorithmic trading strategy backtesting.
This project combines classical quantitative finance models (Geometric Brownian Motion) with modern machine learning techniques (LSTM, Random Forest) and a robust backtesting engine.

![Stock Analysis Dashboard](https://via.placeholder.com/800x400?text=Stock+Analysis+Dashboard)

## ğŸŒŸ Features

### ğŸ“ˆ Stochastic Modeling
- **Geometric Brownian Motion (GBM)** simulation for stock price prediction
- Monte Carlo simulations with thousands of price paths
- Statistical parameter estimation (drift Î¼, volatility Ïƒ)
- Confidence intervals and risk metrics (VaR, CVaR)
- Advanced models: Jump Diffusion (Merton), GARCH volatility forecasting

### ğŸ¤– Machine Learning
- **LSTM Neural Networks** for deep learning time series prediction
- **Random Forest Regressor** with technical indicator feature engineering
- **Gradient Boosting** for ensemble predictions
- Automated feature creation (50+ technical indicators):
  - Moving Averages (SMA, EMA)
  - RSI, MACD, Bollinger Bands
  - Momentum, Rate of Change
  - Volatility measures
- Model performance metrics and visualization

### ğŸ“‰ Algorithmic Trading Backtesting
- Professional-grade backtesting framework
- **5+ Pre-built Trading Strategies**:
  - Moving Average Crossover
  - RSI Mean Reversion
  - Bollinger Bands Breakout
  - Momentum Trading
  - MACD Signal
- Portfolio management with commission tracking
- Comprehensive performance metrics:
  - Sharpe Ratio, Sortino Ratio, Calmar Ratio
  - Maximum Drawdown
  - Win Rate, Profit Factor
  - Risk-adjusted returns

### ğŸ“Š Advanced Visualizations
- Interactive price charts with simulation cones
- Return distribution analysis with Q-Q plots
- Correlation heatmaps for multi-asset portfolios
- Risk metrics dashboard
- Trading signal visualization
- Feature importance plots

### ğŸ’¼ Portfolio Optimization
- Modern Portfolio Theory (Markowitz)
- Efficient Frontier generation
- Maximum Sharpe Ratio optimization
- Multi-asset Monte Carlo simulation
- Portfolio-level risk metrics

### ğŸ“ Options Pricing
- Black-Scholes formula for European options
- Monte Carlo options pricing
- Greeks calculation (Delta, Gamma, Vega, Theta, Rho)
- Implied volatility calculator
- Asian options pricing

## ğŸš€ Quick Start

### Prerequisites
```bash
Python 3.8 or higher
pip (Python package manager)
```

### Installation

1. **Clone the repository**
```bash
git clone https://github.com/yourusername/gbm-stock-analysis.git
cd gbm-stock-analysis
```

2. **Create virtual environment** (recommended)
```bash
python -m venv venv

# On Windows:
venv\Scripts\activate

# On macOS/Linux:
source venv/bin/activate
```

3. **Install dependencies**
```bash
pip install -r requirements.txt
```

### Basic Usage

#### Run GBM Simulation
```bash
python main.py
```

Example interaction:
```
ğŸ“Š Enter stock ticker (e.g., AAPL, TSLA, MSFT): AAPL
ğŸ“… Enter start date (YYYY-MM-DD, e.g., 2020-01-01): 2020-01-01
ğŸ”® Enter forecast period in days (default 252 = 1 year): 252
ğŸ² Enter number of simulations (default 1000): 1000
```

#### Run ML & Backtesting System
```bash
python ml_backtest_main.py
```

This launches an interactive menu with options for:
- Machine learning predictions (LSTM, Random Forest)
- Trading strategy backtesting
- Strategy comparison
- ML-driven trading signals

## ğŸ“ Project Structure

```
GBM Stock Market Analysis/
â”‚
â”œâ”€â”€ main.py                      # GBM simulation entry point
â”œâ”€â”€ ml_backtest_main.py         # ML & backtesting main menu
â”‚
â”œâ”€â”€ data_fetcher.py             # Historical data fetching (yfinance)
â”œâ”€â”€ gbm_simulator.py            # GBM Monte Carlo simulation engine
â”œâ”€â”€ plotter.py                  # Core visualization functions
â”œâ”€â”€ ml_models.py                # Machine learning models (LSTM, RF, etc.)
â”œâ”€â”€ backtesting.py              # Trading strategy backtesting framework
â”‚
â”œâ”€â”€ advanced_models.py          # Jump diffusion, GARCH models
â”œâ”€â”€ options_pricing.py          # Options valuation (Black-Scholes, Greeks)
â”œâ”€â”€ portfolio_optimization.py   # MPT, efficient frontier
â”œâ”€â”€ enhanced_visualizations.py  # Advanced plotting functions
â”‚
â”œâ”€â”€ requirements.txt            # Python dependencies
â”œâ”€â”€ README.md                   # This file
â””â”€â”€ LICENSE                     # MIT License
```

## ğŸ¯ Use Cases

### For Quantitative Analysts
- **Risk Management**: Calculate VaR, CVaR, and stress test portfolios
- **Derivatives Pricing**: Price options using Black-Scholes and Monte Carlo methods
- **Portfolio Optimization**: Construct efficient frontiers and maximize Sharpe ratios

### For Algorithmic Traders
- **Strategy Development**: Backtest trading strategies with realistic commission models
- **Performance Analysis**: Evaluate strategies using industry-standard metrics
- **Signal Generation**: Use ML models to generate trading signals

### For Data Scientists
- **Time Series Forecasting**: Apply LSTM neural networks to financial data
- **Feature Engineering**: Automatically create 50+ technical indicators
- **Model Comparison**: Compare traditional vs. ML approaches

### For Researchers & Students
- **Educational Tool**: Learn quantitative finance and ML concepts
- **Experimentation**: Test hypotheses about market behavior
- **Visualization**: Understand complex financial models through interactive plots

## ğŸ“Š Example Results

### GBM Simulation Output
```
ğŸ“Š SUMMARY STATISTICS FOR AAPL
============================================================
ğŸ“ˆ Model Parameters:
   Annual Drift (Î¼):      0.2847 (28.47%)
   Annual Volatility (Ïƒ): 0.3124 (31.24%)

ğŸ’° Current Price: $175.43

ğŸ¯ Forecast Statistics (after 252 days):
   Mean Final Price:   $221.32
   Median Final Price: $215.67
   Std Deviation:      $68.45
   Min Price:          $89.12
   Max Price:          $445.78

âš ï¸  Risk Metrics:
   95% Value at Risk:  31.24%
   5th Percentile:     $118.54
   95th Percentile:    $367.89
```

### Backtesting Results
```
PERFORMANCE METRICS
====================================
Total Return:             47.23%
Annual Return:            18.92%
Buy & Hold Return:        32.15%
Outperformance:           15.08%

Sharpe Ratio:             1.87
Sortino Ratio:            2.43
Max Drawdown:            -12.34%
Calmar Ratio:             1.53

Volatility:               14.67%
Win Rate:                 58.30%
Profit Factor:            1.92
Total Trades:             47

Final Value:             $14,723.00
```

## ğŸ§ª Technical Details

### GBM Model
The Geometric Brownian Motion model follows the stochastic differential equation:

```
dS = Î¼ * S * dt + Ïƒ * S * dW
```

Where:
- `S` = stock price
- `Î¼` = drift (expected return)
- `Ïƒ` = volatility (standard deviation)
- `dW` = Wiener process (Brownian motion)

Discrete form used in simulation:
```
S(t+1) = S(t) * exp((Î¼ - 0.5*ÏƒÂ²)*Î”t + Ïƒ*âˆšÎ”t*Z)
```

### LSTM Architecture
```
Input Layer: (lookback_period, 1)
    â†“
LSTM Layer 1: 50 units, return_sequences=True
    â†“
Dropout: 0.2
    â†“
LSTM Layer 2: 50 units
    â†“
Dropout: 0.2
    â†“
Dense Layer: 1 unit (output)
```

### Performance Metrics

**Sharpe Ratio**: Measures risk-adjusted returns
```
Sharpe = (Return - Risk_Free_Rate) / Volatility
```

**Maximum Drawdown**: Largest peak-to-trough decline
```
MDD = min((Price - RunningMax) / RunningMax)
```

**Sortino Ratio**: Like Sharpe, but only penalizes downside volatility
```
Sortino = (Return - Risk_Free_Rate) / Downside_Deviation
```

## ğŸ”§ Configuration

### Customize GBM Parameters
In `main.py`, modify:
```python
forecast_days = 252      # 1 year forecast
num_simulations = 1000   # Number of Monte Carlo paths
seed = 42               # Random seed for reproducibility
```

### Adjust ML Model Hyperparameters
In `ml_models.py`:
```python
# LSTM
lookback = 60           # Days of historical data
units = 50              # LSTM units per layer
dropout = 0.2           # Dropout rate
epochs = 50             # Training epochs

# Random Forest
n_estimators = 100      # Number of trees
max_depth = 10          # Maximum tree depth
```

### Backtest Settings
In `backtesting.py`:
```python
initial_capital = 10000  # Starting portfolio value
commission = 0.001       # 0.1% commission per trade
```

## ğŸ“š Dependencies

Core libraries:
- **NumPy**: Numerical computing
- **Pandas**: Data manipulation
- **Matplotlib & Seaborn**: Visualization
- **yfinance**: Historical stock data
- **scikit-learn**: Machine learning models
- **TensorFlow/Keras**: Deep learning (LSTM)
- **SciPy**: Statistical functions
- **statsmodels**: Time series analysis
- **arch**: GARCH models

See `requirements.txt` for complete list with versions.

## ğŸ¤ Contributing

Contributions are welcome! Here's how you can help:

1. **Fork the repository**
2. **Create a feature branch** (`git checkout -b feature/AmazingFeature`)
3. **Commit your changes** (`git commit -m 'Add some AmazingFeature'`)
4. **Push to the branch** (`git push origin feature/AmazingFeature`)
5. **Open a Pull Request**

### Ideas for Contributions
- Add more trading strategies (pairs trading, statistical arbitrage)
- Implement real-time data streaming
- Add sentiment analysis from news/Twitter
- Create web dashboard with Flask/Streamlit
- Add cryptocurrency support
- Implement reinforcement learning for trading

## âš ï¸ Disclaimer

**This software is for educational and research purposes only.**

- This is NOT financial advice
- Past performance does not guarantee future results
- Trading stocks involves substantial risk of loss
- Always do your own research before investing
- The authors are not responsible for any financial losses

## ğŸ“„ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## ğŸ™ Acknowledgments

- **yfinance**: For providing easy access to Yahoo Finance data
- **TensorFlow team**: For the excellent deep learning framework
- **scikit-learn**: For comprehensive ML tools
- **Quantitative finance community**: For theoretical foundations

## ğŸ“§ Contact

**Pulkit Chaudhary**
- GitHub: [@yourusername](https://github.com/yourusername)
- Email: your.email@example.com
- LinkedIn: [Your LinkedIn](https://linkedin.com/in/yourprofile)

## ğŸŒŸ Star History

If you find this project helpful, please consider giving it a star â­!

---

**Built with â¤ï¸ using Python, TensorFlow, and lots of coffee â˜•**

*Last Updated: November 2024*